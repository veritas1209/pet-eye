[env:lilygo-tcamera-s3]
platform = espressif32@6.3.2  ; 이전 버전 사용
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
upload_speed = 115200  ; 속도 낮춤

; 안전한 빌드 플래그
build_flags = 
    -DBOARD_HAS_PSRAM
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DCORE_DEBUG_LEVEL=1  ; 최소 로그
    -DCONFIG_ESP32S3_DEFAULT_CPU_FREQ_160=1  ; CPU 속도 낮춤
    -DPSRAM_SPEED=40  ; PSRAM 속도 낮춤
    -DCONFIG_SPIRAM_CACHE_WORKAROUND=1
    -DCONFIG_SPIRAM_USE_MALLOC=1

; 필수 라이브러리
lib_deps = 
    paulstoffregen/OneWire@^2.3.7
    milesburton/DallasTemperature@^3.11.0
    esp32-camera@1.0.0

; 메모리 설정 (T-Camera S3용) - 더 보수적으로
board_build.partitions = default.csv  ; huge_app.csv 대신
board_build.arduino.memory_type = qio_opi
board_upload.flash_size = 16MB
board_upload.maximum_size = 8388608  ; 8MB로 제한

; 클럭 설정 더 안정적으로
board_build.f_cpu = 240000000L
board_build.f_flash = 80000000L